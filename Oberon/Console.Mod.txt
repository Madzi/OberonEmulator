MODULE Console;

  IMPORT SYSTEM, Texts;

  CONST data = -32;

  PROCEDURE Log*(msg: ARRAY OF CHAR);
    VAR i: INTEGER;
  BEGIN i := 0;
    WHILE msg[i] # 0X DO
      SYSTEM.PUT(data, msg[i]);
      INC(i)
    END;
    SYSTEM.PUT(data, 0)
  END Log;

  PROCEDURE LogText*(T: Texts.Text);
    VAR R: Texts.Reader; ch: CHAR;
  BEGIN
    Texts.OpenReader(R, T, 0);
    WHILE ~R.eot DO
      Texts.Read(R, ch);
      IF ~R.eot THEN SYSTEM.PUT(data, ch) END
    END;
    SYSTEM.PUT(data, 0)
  END LogText;

  PROCEDURE LogBuf*(buf: Texts.Buffer);
    VAR T: Texts.Text;
  BEGIN
    NEW(T);
    Texts.Open(T, "");
    Texts.Append(T, buf);
    LogText(T)
  END LogBuf;

  PROCEDURE Test*;
    VAR W: Texts.Writer;
  BEGIN Log("Hello!");
    Texts.OpenWriter(W);
    Texts.WriteString(W, "The answer is");
    Texts.WriteInt(W, 40+2, 3);
    Texts.WriteLn(W);
    Texts.WriteString(W, "And this is line #2");
    LogBuf(W.buf)
  END Test;

END Console.